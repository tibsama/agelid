<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Manager</title>
        <style>
        body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f4;
    height: 100vh;
    margin: 0;
    padding: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    box-sizing: border-box;
}

.container {
    width: 100%;
    max-width: 1200px;
}

h1 {
    text-align: center;
    margin-bottom: 20px;
}

.input-container {
    text-align: center;
    margin-bottom: 20px;
}

.input-container input[type="text"] {
    width: 20%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 3px;
    margin: 0 5px;
}

.input-container button {
    padding: 10px 15px;
    border: none;
    background-color: #28a745;
    color: white;
    border-radius: 3px;
    cursor: pointer;
    margin: 5px;
}

.input-container button:hover {
    background-color: #218838;
}

.columns {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.column {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #fff;
    padding: 10px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

.column input[type="checkbox"] {
    margin-right: 10px;
}

.remove-button {
    background-color: #dc3545;
    border: none;
    padding: 5px 10px;
    color: white;
    border-radius: 3px;
    cursor: pointer;
}

.remove-button:hover {
    background-color: #c82333;
}

.file-input {
    display: none;
}

.carousel {
    perspective: 1000px;
    position: relative;
    width: 100%;
    max-width: 300px; /* Adjust max-width for better scaling */
    height: 200px; /* Adjust height for mobile */
}

.carousel-container {
    position: absolute;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transform: rotateY(0deg);
    transition: transform 1s cubic-bezier(0.25, 0.1, 0.25, 1);
}

.carousel-item {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
}

.carousel-item img {
    width: 100%;
    height: auto;
    display: block;
}

.controls {
    text-align: center;
    margin-top: 10px;
}

.button-container {
    display: flex;
    justify-content: center;
    gap: 10px;
}

.button-container button {
    padding: 10px;
    border: none;
    border-radius: 4px;
    background-color: #007bff;
    color: #fff;
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.button-container button:hover {
    background-color: #0056b3;
}

.input-wrapper {
    position: relative;
    width: 100%;
    max-width: 300px;
    margin: 10px auto; /* Center input fields horizontally */
}

.input-wrapper + .input-wrapper {
    margin-top: 15px; /* Space between input fields */
}

.animated-input {
    width: 100%;
    padding: 12px;
    border: 2px solid #ccc;
    border-radius: 4px;
    font-size: 14px;
    background-color: #fff;
    transition: all 0.3s ease;
}

.animated-input:focus,
.animated-input:not(:placeholder-shown) {
    border-color: #007bff;
    box-shadow: 0 0 8px rgba(0, 123, 255, 0.5);
}

.floating-label {
    position: absolute;
    top: 50%;
    left: 12px;
    font-size: 14px;
    color: #999;
    pointer-events: none;
    transform: translateY(-50%);
    transition: all 0.3s ease;
}

.animated-input:focus + .floating-label,
.animated-input:not(:placeholder-shown) + .floating-label {
    top: -10px;
    left: 8px;
    font-size: 12px;
    color: #007bff;
}

.order-form {
    margin-top: 20px;
    text-align: center;
}

.order-form input, .order-form button {
    padding: 10px;
    margin: 10px auto;
    font-size: 14px;
    border: 2px solid #007bff;
    border-radius: 4px;
    background-color: #fff;
    cursor: pointer;
    transition: all 0.3s ease;
    display: block; /* Ensure inputs and buttons are block-level elements */
}

.order-form button {
    background-color: #007bff;
    color: #fff;
    border: none;
}

.order-form button:hover {
    background-color: #0056b3;
}

@media (max-width: 600px) {
    /* Adjustments for mobile */
    body {
        padding: 10px;
    }

    .carousel {
        height: 180px;
    }

    .button-container button {
        padding: 8px;
        font-size: 12px;
    }

    .animated-input {
        padding: 10px;
        font-size: 12px;
    }

    .floating-label {
        font-size: 12px;
    }

    .order-form input, .order-form button {
        font-size: 12px;
        padding: 8px;
    }
 .spinner-container {
            margin-left: 20px 0;
        }
        .spinner-label {
            margin-left: 10px;
        }
}
            </style>
</head>
<body>
    <div class="container">

 <div class="spinner-container">
        <label for="spinner" class="spinner-label">plan:</label>
        <select id="spinner" onchange="changeVariable()">
            <option value="1">plan preventif</option>
            <option value="2">plan graissage</option>
            <option value="3">piece a changer</option>
            <option value="4">pannes</option>
        </select>
    </div>

    <div>
        <p>S 1<span id="selectedVariable"></span></p>
    </div>

        <h1>Liste des t√¢ches</h1>
        <div class="input-container">

           <div class="order-form">
        <div class="input-wrapper">
            <input type="tel" id="taskInput1" class="animated-input" placeholder=" " required>
            <label for="customer-name" class="floating-label">numero de ligne</label>
        </div>
        <div class="input-wrapper">
            <input type="email" id="taskInput2" class="animated-input" placeholder=" " required>
            <label for="customer-email" class="floating-label">designation</label>
        </div>
        <div class="input-wrapper">
            <input type="tel" id="taskInput3" class="animated-input" placeholder=" " required>
            <label for="customer-address" class="floating-label">urgence</label>
        </div>
        <div class="input-wrapper">
            <input type="date" id="taskInput4" class="animated-input" placeholder=" " required>
            <label for="customer-phone" class="floating-label">date</label>
        </div>
    </div>

            <button onclick="addTask()">Ajouter</button>
            <input type="file" id="fileInput" class="file-input" accept=".json" onchange="loadTasks(event)">
        </div>
        <div id="tasksList" class="columns"></div>
    </div>


    <script>
        const tasks = [];
        const apiKey = "$2a$10$Ro4u7k0o7xdL5C3Guu/RmOH2p0kVyZTtdQfjXe0gqUk.HEKxtdLxi";
        const binId = "66bd10b3e41b4d34e4207244";

     loadTasksFromCloud();

   let selectedVariable = "1";
        function changeVariable() {
            const spinner = document.getElementById("spinner");
            selectedVariable = spinner.options[spinner.selectedIndex].text;
            document.getElementById("selectedVariable").textContent = selectedVariable;
       

const placeholders = {
            1: ["Numero de ligne", "Designation", "Urgence", "Date"],
            2: ["Plan Name", "Location", "Frequency", "Last Checked"],
            3: ["Piece Name", "Model", "Replacement Date", "Cost"],
            4: ["Panne Type", "Impact", "Detection Date", "Resolution"]
       };
        
        const inputLabels = placeholders[spinner.value];
        inputLabels.forEach((label, index) => {
            document.querySelectorAll('.floating-label')[index].textContent = label;
        });
renderTasks();  }

        function addTask() {
            const inputs = [
                document.getElementById("taskInput1").value,
                document.getElementById("taskInput2").value,
                document.getElementById("taskInput3").value,
                document.getElementById("taskInput4").value
            ];

            if (inputs.every(input => input.trim() === "")) {
                alert("Please enter a task in all fields.");
                return;
            }

            const task = {
                text: inputs,
                checked: false, // Initial checkbox state
                category: selectedVariable,
                id: new Date().getTime()
            };
            tasks.push(task);
            renderTasks();
            inputs.forEach((_, index) => {
                document.getElementById("taskInput" + (index + 1)).value = "";
            });

             saveTasksToCloud();
        }

        function renderTasks() {
            const tasksList = document.getElementById("tasksList");
            tasksList.innerHTML = "";

               tasks.forEach(task => {
//tasks.filter(task => task.category === selectedVariable).forEach(task => {
                const column = document.createElement("div");
                column.className = "column";
                
                task.text.forEach(text => {
                    const span = document.createElement("span");
                    span.textContent = text;
                    column.appendChild(span);
                });

                const checkbox = document.createElement("input");
                checkbox.type = "checkbox";
                checkbox.checked = task.checked;
                checkbox.onchange = function() {
                    task.checked = checkbox.checked; // Update task's checked state

                saveTasksToCloud();
                    
                };
                column.appendChild(checkbox);

                const removeButton = document.createElement("button");
                removeButton.textContent = "supprimer";
                removeButton.className = "remove-button";
                removeButton.onclick = function() {
                    removeTask(task.id);
                };
                column.appendChild(removeButton);

                tasksList.appendChild(column);
            });
        }

        function removeTask(taskId) {
            const index = tasks.findIndex(task => task.id === taskId);
            if (index > -1) {
                tasks.splice(index, 1);
            }
            renderTasks();
            saveTasksToCloud();
        }


    function saveTasksToCloud() {
            const xhr = new XMLHttpRequest();
            xhr.open("PUT", `https://api.jsonbin.io/v3/b/${binId}`, true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.setRequestHeader("X-Master-Key", apiKey);
            xhr.onreadystatechange = function () {
             //   if (xhr.readyState === 4 && xhr.status === 200) {
               //     alert("Tasks saved to cloud!");
              //  }
            };
            xhr.send(JSON.stringify({ tasks }));
        }

        function loadTasksFromCloud() {
            const xhr = new XMLHttpRequest();
            xhr.open("GET", `https://api.jsonbin.io/v3/b/${binId}/latest`, true);
            xhr.setRequestHeader("X-Master-Key", apiKey);
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    const response = JSON.parse(xhr.responseText);
                    tasks.length = 0;
                    tasks.push(...response.record.tasks);
                    renderTasks();
                }
            };
            xhr.send();
        }


    </script>
</body>
</html>
