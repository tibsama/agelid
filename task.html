<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Manager</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table, th, td {
            border: 1px solid black;
        }

        th, td {
            padding: 10px;
            text-align: left;
        }

        tr.green {
            background-color: #d4edda;
        }

        tr.red {
            background-color: #f8d7da;
        }

        input[type="checkbox"] {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Liste des anomalies</h1>
        <table id="tasksTable">
            <thead>
                <tr>
                    <th>Numéro de Ligne</th>
                    <th>Désignation</th>
                    <th>Urgence</th>
                    <th>Date</th>
                    <th>Résolu</th>
                </tr>
            </thead>
            <tbody>
                <!-- Les données seront insérées ici -->
            </tbody>
        </table>
    </div>

    <script src="https://www.gstatic.com/firebasejs/4.7.0/firebase.js"></script>
    <script>
        // Config Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDNo-zAANxCw6c9b_4RQGtqQLGueeMQ8nA",
            authDomain: "herher-d121a.firebaseapp.com",
            databaseURL: "https://herher-d121a.firebaseio.com",
            projectId: "herher-d121a",
            storageBucket: "herher-d121a.appspot.com",
            messagingSenderId: "626438737297",
            appId: "1:626438737297:web:bf6524275291ec695fde30"
        };

        // Initialiser Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Récupérer les données depuis la référence 'anomalie'
        function loadTasks() {
            const tableBody = document.querySelector("#tasksTable tbody");
            database.ref('anomalie').once('value', (snapshot) => {
                snapshot.forEach((childSnapshot) => {
                    const anomaly = childSnapshot.val();

                    // Créer une nouvelle ligne de tableau
                    const row = document.createElement('tr');
                    row.classList.add('red'); // Rouge par défaut si non cochée

                    // Ajouter les cellules avec les données
                    row.innerHTML = `
                        <td>${anomaly.numero_ligne}</td>
                        <td>${anomaly.designation}</td>
                        <td>${anomaly.urgence}</td>
                        <td>${anomaly.date}</td>
                        <td><input type="checkbox"></td>
                    `;

                    // Ajouter un événement pour changer la couleur de la ligne
                    const checkbox = row.querySelector('input[type="checkbox"]');
                    checkbox.addEventListener('change', function () {
                        if (this.checked) {
                            row.classList.remove('red');
                            row.classList.add('green');
                        } else {
                            row.classList.remove('green');
                            row.classList.add('red');
                        }
                    });

                    // Ajouter la ligne au tableau
                    tableBody.appendChild(row);
                });
            });
        }

        // Charger les tâches au chargement de la page
        window.onload = loadTasks;
    </script>
</body>
</html>
